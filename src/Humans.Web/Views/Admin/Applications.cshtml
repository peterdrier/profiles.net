@model Humans.Web.Models.AdminApplicationListViewModel
@{
    ViewData["Title"] = Localizer["AdminApplications_Title"].Value;
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>@Localizer["AdminApplications_Title"]</h1>
    <span class="text-muted">@string.Format(Localizer["Admin_TotalCount"].Value, Model.TotalCount)</span>
</div>

<div class="card mb-4">
    <div class="card-body d-flex flex-wrap gap-3 align-items-center">
        <div class="btn-group" role="group">
            <a asp-action="Applications" asp-route-tier="@Model.TierFilter" class="btn @(string.IsNullOrEmpty(Model.StatusFilter) ? "btn-primary" : "btn-outline-primary")">
                @Localizer["AdminApp_Pending"]
            </a>
            <a asp-action="Applications" asp-route-status="Approved" asp-route-tier="@Model.TierFilter" class="btn @(Model.StatusFilter == "Approved" ? "btn-primary" : "btn-outline-primary")">
                @Localizer["AdminHuman_Approved"]
            </a>
            <a asp-action="Applications" asp-route-status="Rejected" asp-route-tier="@Model.TierFilter" class="btn @(Model.StatusFilter == "Rejected" ? "btn-primary" : "btn-outline-primary")">
                @Localizer["AdminApp_Rejected"]
            </a>
            <a asp-action="Applications" asp-route-status="Withdrawn" asp-route-tier="@Model.TierFilter" class="btn @(Model.StatusFilter == "Withdrawn" ? "btn-primary" : "btn-outline-primary")">
                @Localizer["AdminApp_Withdrawn"]
            </a>
        </div>
        <div class="btn-group" role="group">
            <a asp-action="Applications" asp-route-status="@Model.StatusFilter" class="btn @(string.IsNullOrEmpty(Model.TierFilter) ? "btn-secondary" : "btn-outline-secondary") btn-sm">
                All Tiers
            </a>
            <a asp-action="Applications" asp-route-status="@Model.StatusFilter" asp-route-tier="Colaborador" class="btn @(Model.TierFilter == "Colaborador" ? "btn-secondary" : "btn-outline-secondary") btn-sm">
                Colaborador
            </a>
            <a asp-action="Applications" asp-route-status="@Model.StatusFilter" asp-route-tier="Asociado" class="btn @(Model.TierFilter == "Asociado" ? "btn-secondary" : "btn-outline-secondary") btn-sm">
                Asociado
            </a>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-body p-0">
        @if (Model.Applications.Count == 0)
        {
            <p class="text-muted text-center py-4 mb-0">@Localizer["AdminApp_NoApplicationsFound"]</p>
        }
        else
        {
            <table class="table table-hover mb-0">
                <thead>
                    <tr>
                        <th>@Localizer["AdminApp_Applicant"]</th>
                        <th>@Localizer["BoardVoting_Tier"]</th>
                        <th>@Localizer["Governance_Submitted"]</th>
                        <th>@Localizer["Common_Status"]</th>
                        <th>@Localizer["AdminApp_Preview"]</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var app in Model.Applications)
                    {
                        <tr>
                            <td>
                                <div>@app.UserDisplayName</div>
                                <small class="text-muted">@app.UserEmail</small>
                            </td>
                            <td><span class="badge bg-info">@app.MembershipTier</span></td>
                            <td>@app.SubmittedAt.ToString("d MMM yyyy")</td>
                            <td>
                                <span class="badge @app.StatusBadgeClass">@app.Status</span>
                            </td>
                            <td>
                                <small class="text-muted">@app.MotivationPreview</small>
                            </td>
                            <td class="text-end">
                                <a asp-action="ApplicationDetail" asp-route-id="@app.Id" class="btn btn-sm btn-outline-primary">
                                    @Localizer["AdminApp_Review"]
                                </a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        }
    </div>
</div>

@if (Model.TotalCount > Model.PageSize)
{
    var totalPages = (int)Math.Ceiling((double)Model.TotalCount / Model.PageSize);
    <nav class="mt-4">
        <ul class="pagination justify-content-center">
            @for (var i = 1; i <= totalPages && i <= 10; i++)
            {
                <li class="page-item @(i == Model.PageNumber ? "active" : "")">
                    <a class="page-link" asp-action="Applications" asp-route-page="@i" asp-route-status="@Model.StatusFilter" asp-route-tier="@Model.TierFilter">@i</a>
                </li>
            }
        </ul>
    </nav>
}
