@using Microsoft.AspNetCore.Localization
@{
    var requestCulture = Context.Features.Get<IRequestCultureFeature>();
    var currentCulture = requestCulture?.RequestCulture.UICulture.TwoLetterISOLanguageName ?? "en";

    var languages = new[]
    {
        ("de", "Deutsch"),
        ("en", "English"),
        ("es", "Español"),
        ("fr", "Français"),
        ("it", "Italiano")
    };

    var currentLanguageName = languages.FirstOrDefault(l => string.Equals(l.Item1, currentCulture, StringComparison.Ordinal)).Item2 ?? "English";
}

<div class="dropdown">
    <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
        @currentLanguageName
    </button>
    <ul class="dropdown-menu dropdown-menu-end">
        @foreach (var (culture, name) in languages)
        {
            <li>
                <form asp-controller="Language" asp-action="SetLanguage" method="post">
                    @Html.AntiForgeryToken()
                    <input type="hidden" name="culture" value="@culture" />
                    <input type="hidden" name="returnUrl" value="@Context.Request.Path" />
                    <button type="submit" class="dropdown-item @(string.Equals(culture, currentCulture, StringComparison.Ordinal) ? "active" : "")">
                        @name
                    </button>
                </form>
            </li>
        }
    </ul>
</div>
